# [PE-EXPLOIT-008]: AKS Container Escape (CVE-2025-21196)

## Metadata
| Attribute | Details |
|---|---|
| **Technique ID** | PE-EXPLOIT-008 |
| **MITRE ATT&CK v18.1** | [Escape to Host (T1611)](https://attack.mitre.org/techniques/T1611/) |
| **Tactic** | Privilege Escalation |
| **Platforms** | Azure Kubernetes Service (AKS) |
| **Severity** | **Critical** |
| **CVE** | **CVE-2025-21196** |
| **Author** | SERVTEP (Pchelnikau Artur) |

## 2. EXECUTIVE SUMMARY
- **Concept:** A critical vulnerability in the Azure Kubernetes Service (AKS) management plane allows attackers to bypass isolation boundaries. Specifically, ineffective access controls in the Azure container management service allow an authenticated attacker (with basic cluster user rights) to leverage the Kubernetes API to elevate privileges or execute code on the underlying node, bypassing the configured Security Context.
- **Attack Surface:** AKS API Server / Kubelet.
- **Business Impact:** **Cluster Takeover**. Escaping the pod sandbox to control the entire AKS cluster node.

## 3. PREREQUISITES & CONFIGURATION
- **Required Privileges:** Authenticated User (Cluster Role: User/Reader).
- **Tools:** `kubectl`, Custom Exploit Script.

## 4. ATTACK (Red Team Operations)

#### 4.1 Usage
**Step 1: Exploit API Misconfiguration**
Send a crafted request to the API server bypassing the Admission Controller validation.
```bash
# Conceptual Exploit
kubectl apply -f malicious-pod.yaml --validate=false
```

**Step 2: Trigger Vulnerability**
The vulnerability allows the pod to launch with elevated privileges despite restrictions.
*Result: Root shell on the AKS node.*

## 5. DETECTION (Blue Team Operations)

#### 5.1 Azure Activity Logs
| Source | Event | Filter Logic |
|---|---|---|
| **AKS Audit** | `PrivilegedContainer` | Pod creation events that violate Policy but succeed due to the exploit. |

## 6. DEFENSE & REMEDIATION (Hardening)

#### 6.2 Immediate Remediation
*   **Patching:** Upgrade AKS Cluster version immediately (Microsoft patched this in Feb 2025).
*   **Policy:** Enable Azure Policy for Kubernetes to enforce "Restricted" standards at the admission level (Gatekeeper).

## 7. ATTACK CHAIN
> **Preceding Technique:** [IA-CLOUD-003]
> **Next Logical Step:** [CA-TOKEN-013]
